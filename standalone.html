<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Risk Monitor</title>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body, #root { width: 100%; min-height: 100vh; display: flex; }
    :root {
      --primary: #3b82f6;
      --primary-light: #60a5fa;
      --primary-dark: #2563eb;
      --bg-main: #0a0a0f;
      --bg-sidebar: #0d0d1a;
      --bg-card: #12121f;
      --bg-card-hover: #1a1a2e;
      --bg-elevated: #1e1e32;
      --bg-input: #15152a;
      --text-primary: #f8fafc;
      --text-secondary: #94a3b8;
      --text-muted: #64748b;
      --border: rgba(255, 255, 255, 0.08);
      --border-focus: rgba(59, 130, 246, 0.5);
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --radius: 8px;
      --radius-md: 10px;
      --radius-lg: 12px;
      --transition-fast: 0.15s ease;
      --transition-normal: 0.25s ease;
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
      --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
    }

    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: var(--bg-main);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
    }

    /* Sidebar */
    .sidebar {
      width: 280px;
      background: var(--bg-sidebar);
      border-right: 1px solid var(--border);
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      display: flex;
      flex-direction: column;
      z-index: 100;
    }

    .sidebar-header {
      padding: 24px;
      border-bottom: 1px solid var(--border);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      width: 42px;
      height: 42px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-icon svg {
      width: 24px;
      height: 24px;
      color: white;
    }

    .logo-text h1 {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text-primary);
    }

    .logo-text span {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .sidebar-nav {
      flex: 1;
      overflow-y: auto;
      padding: 16px 12px;
    }

    .nav-section-title {
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 12px 12px 8px;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 14px;
      border-radius: var(--radius);
      cursor: pointer;
      transition: all var(--transition-fast);
      margin-bottom: 4px;
      border: none;
      background: transparent;
      width: 100%;
      text-align: left;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .nav-item:hover {
      background: var(--bg-card-hover);
      color: var(--text-primary);
    }

    .nav-item.active {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(59, 130, 246, 0.05));
      color: var(--primary-light);
      border-left: 3px solid var(--primary);
    }

    .nav-item svg {
      width: 20px;
      height: 20px;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      margin-left: 280px;
      min-height: 100vh;
    }

    .header {
      height: 72px;
      background: var(--bg-sidebar);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 32px;
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .header-title h2 {
      font-size: 1.25rem;
      font-weight: 600;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .header-btn {
      width: 42px;
      height: 42px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: var(--bg-card);
      color: var(--text-secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
    }

    .header-btn:hover {
      background: var(--bg-elevated);
      color: var(--primary-light);
      border-color: var(--border-focus);
    }

    .header-btn svg {
      width: 18px;
      height: 18px;
    }

    .header-btn.refreshing svg {
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .search-box {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 0 16px;
      height: 42px;
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      width: 280px;
    }

    .search-box svg {
      width: 18px;
      height: 18px;
      color: var(--text-muted);
    }

    .search-box input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      color: var(--text-primary);
      font-size: 0.9rem;
    }

    .search-box input::placeholder {
      color: var(--text-muted);
    }

    /* Dashboard */
    .dashboard {
      padding: 32px;
    }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 24px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 24px;
    }

    .stat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .stat-icon {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stat-icon.blue { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }
    .stat-icon.green { background: rgba(16, 185, 129, 0.15); color: #34d399; }
    .stat-icon.yellow { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
    .stat-icon.red { background: rgba(239, 68, 68, 0.15); color: #f87171; }

    .stat-icon svg {
      width: 24px;
      height: 24px;
    }

    .stat-trend {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 0.8rem;
      font-weight: 500;
    }

    .stat-trend.up { color: var(--success); }
    .stat-trend.down { color: var(--danger); }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .stat-label {
      color: var(--text-muted);
      font-size: 0.875rem;
    }

    /* Table */
    .table-container {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }

    .table-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
    }

    .table-header h3 {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .table-filters {
      display: flex;
      gap: 8px;
    }

    .filter-btn {
      padding: 8px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text-secondary);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .filter-btn:hover, .filter-btn.active {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th {
      text-align: left;
      padding: 14px 24px;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 1px solid var(--border);
      background: var(--bg-elevated);
    }

    td {
      padding: 16px 24px;
      font-size: 0.9rem;
      border-bottom: 1px solid var(--border);
    }

    tr:hover td {
      background: var(--bg-card-hover);
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 100px;
      font-size: 0.75rem;
      font-weight: 500;
    }

    .status-badge.critical { background: rgba(239, 68, 68, 0.15); color: #f87171; }
    .status-badge.high { background: rgba(249, 115, 22, 0.15); color: #fb923c; }
    .status-badge.medium { background: rgba(245, 158, 11, 0.15); color: #fbbf24; }
    .status-badge.good { background: rgba(16, 185, 129, 0.15); color: #34d399; }
    .status-badge.low { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }

    .status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: currentColor;
    }

    /* User Menu */
    .user-menu-container {
      position: relative;
    }

    .user-menu-trigger {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 6px 12px 6px 6px;
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .user-menu-trigger:hover {
      background: var(--bg-card-hover);
    }

    .user-avatar {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .user-avatar svg {
      width: 18px;
      height: 18px;
      color: white;
    }

    .user-name {
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--text-primary);
    }

    .user-chevron {
      width: 16px;
      height: 16px;
      color: var(--text-muted);
    }

    .user-menu-dropdown {
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      min-width: 240px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      padding: 8px;
      z-index: 1000;
    }

    .user-menu-header {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 8px;
    }

    .user-avatar-large {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .user-avatar-large svg {
      width: 24px;
      height: 24px;
      color: white;
    }

    .user-info {
      display: flex;
      flex-direction: column;
    }

    .user-fullname {
      font-weight: 600;
      color: var(--text-primary);
    }

    .user-role {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .user-menu-item {
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      padding: 12px;
      background: transparent;
      border: none;
      border-radius: var(--radius);
      color: var(--text-secondary);
      font-size: 0.875rem;
      cursor: pointer;
      transition: all var(--transition-fast);
      text-align: left;
    }

    .user-menu-item:hover {
      background: var(--bg-card-hover);
      color: var(--text-primary);
    }

    .user-menu-item.logout:hover {
      background: rgba(239, 68, 68, 0.1);
      color: var(--danger);
    }

    .user-menu-item svg {
      width: 18px;
      height: 18px;
    }

    .user-menu-overlay {
      position: fixed;
      inset: 0;
      z-index: 999;
    }

    /* Export Menu */
    .export-menu-container {
      position: relative;
    }

    .export-menu-dropdown {
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      min-width: 220px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      padding: 8px;
      z-index: 1000;
    }

    .export-menu-item {
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      padding: 12px 14px;
      background: transparent;
      border: none;
      border-radius: var(--radius);
      color: var(--text-primary);
      font-size: 0.875rem;
      cursor: pointer;
      transition: all var(--transition-fast);
      text-align: left;
    }

    .export-menu-item:hover {
      background: var(--bg-card-hover);
      color: var(--primary);
    }

    .export-menu-item svg {
      width: 18px;
      height: 18px;
      color: var(--text-muted);
    }

    .export-menu-item:hover svg {
      color: var(--primary);
    }

    .export-menu-overlay {
      position: fixed;
      inset: 0;
      z-index: 999;
    }

    /* Login Page */
    .login-container {
      display: flex;
      min-height: 100vh;
      width: 100%;
    }

    .login-left {
      flex: 1;
      background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 60px;
    }

    .login-left-content {
      max-width: 500px;
    }

    .login-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 32px;
    }

    .login-logo-icon {
      width: 48px;
      height: 48px;
      background: var(--primary);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .login-logo-icon svg {
      width: 28px;
      height: 28px;
      color: white;
    }

    .login-logo span {
      font-size: 1.5rem;
      font-weight: 700;
      color: white;
    }

    .login-left h2 {
      font-size: 2.5rem;
      font-weight: 800;
      color: white;
      line-height: 1.2;
      margin-bottom: 16px;
    }

    .login-left h2 span {
      color: var(--primary-light);
    }

    .login-left-desc {
      font-size: 1.1rem;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.6;
      margin-bottom: 40px;
    }

    .login-right {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f8fafc;
      padding: 40px;
    }

    .login-form-card {
      width: 100%;
      max-width: 420px;
      background: white;
      border-radius: 24px;
      padding: 48px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    }

    .login-main-icon {
      width: 64px;
      height: 64px;
      margin: 0 auto 24px;
      background: var(--primary);
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .login-main-icon svg {
      width: 32px;
      height: 32px;
      color: white;
    }

    .login-form-card h1 {
      font-size: 1.75rem;
      font-weight: 700;
      color: #1e293b;
      margin-bottom: 8px;
      text-align: center;
    }

    .login-subtitle {
      font-size: 0.9rem;
      color: #64748b;
      margin-bottom: 32px;
      text-align: center;
    }

    .login-error {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 16px;
      margin-bottom: 20px;
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 12px;
      color: #dc2626;
      font-size: 0.875rem;
    }

    .login-error svg {
      width: 18px;
      height: 18px;
    }

    .input-group {
      margin-bottom: 20px;
    }

    .input-group label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      color: #374151;
      margin-bottom: 8px;
    }

    .input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .input-icon {
      position: absolute;
      left: 14px;
      width: 20px;
      height: 20px;
      color: #9ca3af;
    }

    .input-wrapper input {
      width: 100%;
      padding: 14px 14px 14px 46px;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      font-size: 0.95rem;
      color: #1e293b;
      transition: all 0.2s;
    }

    .input-wrapper input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .password-toggle {
      position: absolute;
      right: 14px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
    }

    .password-toggle svg {
      width: 20px;
      height: 20px;
      color: #9ca3af;
    }

    .login-options {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-size: 0.875rem;
      color: #64748b;
    }

    .checkbox-label input {
      width: 18px;
      height: 18px;
      accent-color: var(--primary);
    }

    .forgot-link {
      font-size: 0.875rem;
      color: var(--primary);
      text-decoration: none;
    }

    .forgot-link:hover {
      text-decoration: underline;
    }

    .login-btn {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
    }

    .login-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    .login-btn svg {
      width: 20px;
      height: 20px;
    }

    .spinner {
      animation: spin 1s linear infinite;
    }

    .demo-hint {
      margin-top: 24px;
      text-align: center;
      font-size: 0.8rem;
      color: #64748b;
    }

    /* Theme Toggle */
    .theme-toggle {
      width: 56px;
      height: 32px;
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: 100px;
      cursor: pointer;
      position: relative;
      padding: 0;
    }

    .toggle-track {
      position: relative;
      width: 100%;
      height: 100%;
    }

    .toggle-thumb {
      position: absolute;
      top: 4px;
      left: 4px;
      width: 22px;
      height: 22px;
      background: var(--primary);
      border-radius: 50%;
      transition: all 0.3s;
    }

    .toggle-icon {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 14px;
      height: 14px;
    }

    .toggle-icon.sun {
      left: 8px;
      color: var(--text-muted);
    }

    .toggle-icon.moon {
      right: 8px;
      color: white;
    }

    /* Dashboard Cards */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 24px;
      margin-top: 24px;
    }

    .dashboard-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
    }

    .card-header h3 {
      font-size: 1rem;
      font-weight: 600;
    }

    .card-content {
      padding: 20px 24px;
    }

    .card-btn {
      padding: 6px 12px;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text-secondary);
      font-size: 0.75rem;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .card-btn:hover {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
    }

    /* Pagination */
    .pagination {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      border-top: 1px solid var(--border);
    }

    .pagination-info {
      font-size: 0.875rem;
      color: var(--text-muted);
    }

    .pagination-buttons {
      display: flex;
      gap: 8px;
    }

    .pagination-btn {
      padding: 8px 16px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text-secondary);
      font-size: 0.875rem;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .pagination-btn:hover:not(:disabled) {
      background: var(--bg-card-hover);
      color: var(--text-primary);
    }

    .pagination-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    @media (max-width: 1200px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .dashboard-grid { grid-template-columns: 1fr; }
    }

    @media (max-width: 768px) {
      .sidebar { display: none; }
      .main-content { margin-left: 0; }
      .stats-grid { grid-template-columns: 1fr; }
      .login-left { display: none; }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // Data
    const riskCategories = [
      { id: 'all', name: "Barcha yo'nalishlar" },
      { id: 'korrupsiya', name: "Moliyaviy nazorat" },
      { id: 'huquqiy', name: 'Huquqiy' },
      { id: 'akademik', name: 'Akademik' },
      { id: 'diplom', name: 'Diplom' },
      { id: 'talaba', name: 'Talaba' },
      { id: 'talim_shakli', name: "Ta'lim shakli" },
      { id: 'moliya', name: 'Moliya' },
      { id: 'ish', name: 'Ish / Bandlik' },
      { id: 'ttj', name: 'TTJ' },
      { id: 'kadrlar', name: 'Kadrlar' },
      { id: 'qoshimcha', name: "Qo'shimcha" },
    ];

    const initialIndicators = [
      { id: 1, category: 'korrupsiya', name: "Arxivdan qayta tiklangan talabalar", value: "23", status: 'critical', dataSource: 'HEMIS', lastUpdated: '14:30' },
      { id: 2, category: 'korrupsiya', name: "DTM balidan past qabul qilinganlar", value: "12", status: 'critical', dataSource: 'DTM + HEMIS', lastUpdated: '14:25' },
      { id: 3, category: 'korrupsiya', name: "Baholar muddat o'tgandan keyin o'zgartirilgan", value: "87", status: 'high', dataSource: 'HEMIS Audit', lastUpdated: '14:20' },
      { id: 4, category: 'huquqiy', name: "Akkreditatsiya muddati tugagan yo'nalishlar", value: "3", status: 'critical', dataSource: 'Akkreditatsiya baza', lastUpdated: '13:45' },
      { id: 5, category: 'huquqiy', name: "Noqonuniy diplomlar aniqlangan", value: "12", status: 'critical', dataSource: 'Tekshiruv', lastUpdated: '13:30' },
      { id: 6, category: 'akademik', name: "Plagiatizm aniqlangan ishlar", value: "45", status: 'critical', dataSource: 'Antiplagiat', lastUpdated: '12:15' },
      { id: 7, category: 'akademik', name: "Akademik qarzdorlik darajasi", value: "15%", status: 'high', dataSource: 'HEMIS', lastUpdated: '12:00' },
      { id: 8, category: 'diplom', name: "Bitirgan lekin diplom olmaganlar", value: "156", status: 'critical', dataSource: 'HEMIS', lastUpdated: '11:45' },
      { id: 9, category: 'talaba', name: "Ikki OTMda bir vaqtda o'qiyotganlar", value: "8", status: 'critical', dataSource: 'HEMIS', lastUpdated: '11:30' },
      { id: 10, category: 'moliya', name: "1 yildan ortiq to'lov qilmaganlar", value: "127", status: 'critical', dataSource: 'Billing', lastUpdated: '11:15' },
      { id: 11, category: 'moliya', name: "Umumiy qarzdorlik summasi", value: "4.75 mlrd", status: 'critical', dataSource: 'Billing', lastUpdated: '11:00' },
      { id: 12, category: 'kadrlar', name: "Arvoh xodimlar", value: "23", status: 'critical', dataSource: 'Kadrlar', lastUpdated: '10:45' },
      { id: 13, category: 'ttj', name: "TTJda joy yetishmasligi", value: "456", status: 'high', dataSource: 'HEMIS', lastUpdated: '10:30' },
      { id: 14, category: 'qoshimcha', name: "IT tizimlar uzilishi", value: "7", status: 'high', dataSource: 'IT bo\'limi', lastUpdated: '10:15' },
      { id: 15, category: 'talim_shakli', name: "Sirtqi ta'limda ruxsatsiz yo'nalishlar", value: "4", status: 'critical', dataSource: 'HEMIS', lastUpdated: '10:00' },
    ];

    const getStatusLabel = (status) => {
      switch(status) {
        case 'good': return 'Yaxshi';
        case 'low': return 'Past';
        case 'medium': return "O'rta";
        case 'high': return 'Yuqori';
        case 'critical': return 'Kritik';
        default: return "Noma'lum";
      }
    };

    // Icons
    const ShieldIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
      </svg>
    );

    const UserIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
        <circle cx="12" cy="7" r="4"/>
      </svg>
    );

    const SearchIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
    );

    const RefreshIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M23 4v6h-6M1 20v-6h6"/>
        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
      </svg>
    );

    const DownloadIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
    );

    const LogoutIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
        <polyline points="16 17 21 12 16 7"/>
        <line x1="21" y1="12" x2="9" y2="12"/>
      </svg>
    );

    const SettingsIcon = () => (
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <circle cx="12" cy="12" r="3"/>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
      </svg>
    );

    // Login Component
    function Login({ onLogin }) {
      const [login, setLogin] = useState('');
      const [password, setPassword] = useState('');
      const [showPassword, setShowPassword] = useState(false);
      const [rememberMe, setRememberMe] = useState(false);
      const [error, setError] = useState('');
      const [loading, setLoading] = useState(false);

      const handleSubmit = async (e) => {
        e.preventDefault();
        setError('');

        if (!login.trim()) {
          setError('Loginni kiriting');
          return;
        }
        if (!password.trim()) {
          setError('Parolni kiriting');
          return;
        }

        setLoading(true);
        await new Promise(resolve => setTimeout(resolve, 800));

        const userData = {
          id: 1,
          username: login.trim(),
          fullName: login.trim().charAt(0).toUpperCase() + login.trim().slice(1),
          role: 'admin'
        };

        if (rememberMe) {
          localStorage.setItem('user', JSON.stringify(userData));
        } else {
          sessionStorage.setItem('user', JSON.stringify(userData));
        }

        onLogin(userData);
      };

      return (
        <div className="login-container">
          <div className="login-left">
            <div className="login-left-content">
              <div className="login-logo">
                <div className="login-logo-icon">
                  <ShieldIcon />
                </div>
                <span>Risk Monitor</span>
              </div>
              <h2>Xavflarni <span>Real Vaqtda</span> Aniqlang</h2>
              <p className="login-left-desc">
                HEMIS, Billing va TTJ platformalari bilan integratsiya orqali ta'lim muassasangiz xavfsizligini ta'minlang
              </p>
            </div>
          </div>

          <div className="login-right">
            <div className="login-form-card">
              <div className="login-main-icon">
                <ShieldIcon />
              </div>
              <h1>Tizimga kirish</h1>
              <p className="login-subtitle">Xush kelibsiz! Davom etish uchun kiring</p>

              {error && (
                <div className="login-error">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                  </svg>
                  {error}
                </div>
              )}

              <form onSubmit={handleSubmit}>
                <div className="input-group">
                  <label>Login</label>
                  <div className="input-wrapper">
                    <UserIcon className="input-icon" />
                    <input
                      type="text"
                      value={login}
                      onChange={(e) => setLogin(e.target.value)}
                      placeholder="Loginni kiriting"
                      disabled={loading}
                    />
                  </div>
                </div>

                <div className="input-group">
                  <label>Parol</label>
                  <div className="input-wrapper">
                    <svg className="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                      <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                      <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                    </svg>
                    <input
                      type={showPassword ? 'text' : 'password'}
                      value={password}
                      onChange={(e) => setPassword(e.target.value)}
                      placeholder="••••••••"
                      disabled={loading}
                    />
                    <button
                      type="button"
                      className="password-toggle"
                      onClick={() => setShowPassword(!showPassword)}
                    >
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                        <circle cx="12" cy="12" r="3"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <div className="login-options">
                  <label className="checkbox-label">
                    <input
                      type="checkbox"
                      checked={rememberMe}
                      onChange={(e) => setRememberMe(e.target.checked)}
                    />
                    Eslab qolish
                  </label>
                  <a href="#" className="forgot-link">Parolni unutdingizmi?</a>
                </div>

                <button type="submit" className="login-btn" disabled={loading}>
                  {loading ? (
                    <>
                      <svg className="spinner" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" strokeWidth="3" opacity="0.25"/>
                        <path d="M12 2a10 10 0 0 1 10 10" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round"/>
                      </svg>
                      Tekshirilmoqda...
                    </>
                  ) : (
                    <>
                      Kirish
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                      </svg>
                    </>
                  )}
                </button>
              </form>

              <p className="demo-hint">
                Istalgan login va parol bilan kirish mumkin
              </p>
            </div>
          </div>
        </div>
      );
    }

    // Sidebar Component
    function Sidebar({ activeCategory, setActiveCategory }) {
      return (
        <aside className="sidebar">
          <div className="sidebar-header">
            <div className="logo">
              <div className="logo-icon">
                <ShieldIcon />
              </div>
              <div className="logo-text">
                <h1>Risk Monitor</h1>
                <span>v2.0</span>
              </div>
            </div>
          </div>

          <nav className="sidebar-nav">
            <div className="nav-section-title">Kategoriyalar</div>
            {riskCategories.map(cat => (
              <button
                key={cat.id}
                className={`nav-item ${activeCategory === cat.id ? 'active' : ''}`}
                onClick={() => setActiveCategory(cat.id)}
              >
                <ShieldIcon />
                <span>{cat.name}</span>
              </button>
            ))}
          </nav>
        </aside>
      );
    }

    // Dashboard Component
    function Dashboard() {
      const criticalCount = initialIndicators.filter(i => i.status === 'critical').length;
      const highCount = initialIndicators.filter(i => i.status === 'high').length;

      return (
        <div className="dashboard">
          <div className="stats-grid">
            <div className="stat-card">
              <div className="stat-header">
                <div className="stat-icon blue">
                  <ShieldIcon />
                </div>
                <span className="stat-trend up">+12%</span>
              </div>
              <div className="stat-value">{initialIndicators.length}</div>
              <div className="stat-label">Jami indikatorlar</div>
            </div>
            <div className="stat-card">
              <div className="stat-header">
                <div className="stat-icon red">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="12"/>
                    <line x1="12" y1="16" x2="12.01" y2="16"/>
                  </svg>
                </div>
                <span className="stat-trend down">-5%</span>
              </div>
              <div className="stat-value">{criticalCount}</div>
              <div className="stat-label">Kritik xavflar</div>
            </div>
            <div className="stat-card">
              <div className="stat-header">
                <div className="stat-icon yellow">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                    <line x1="12" y1="9" x2="12" y2="13"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                  </svg>
                </div>
                <span className="stat-trend up">+8%</span>
              </div>
              <div className="stat-value">{highCount}</div>
              <div className="stat-label">Yuqori xavflar</div>
            </div>
            <div className="stat-card">
              <div className="stat-header">
                <div className="stat-icon green">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                  </svg>
                </div>
              </div>
              <div className="stat-value">{riskCategories.length - 1}</div>
              <div className="stat-label">Kategoriyalar</div>
            </div>
          </div>

          <div className="table-container">
            <div className="table-header">
              <h3>So'nggi xavflar</h3>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Indikator nomi</th>
                  <th>Qiymat</th>
                  <th>Status</th>
                  <th>Manba</th>
                  <th>Yangilangan</th>
                </tr>
              </thead>
              <tbody>
                {initialIndicators.slice(0, 8).map(ind => (
                  <tr key={ind.id}>
                    <td>{ind.name}</td>
                    <td><strong>{ind.value}</strong></td>
                    <td>
                      <span className={`status-badge ${ind.status}`}>
                        <span className="status-dot"></span>
                        {getStatusLabel(ind.status)}
                      </span>
                    </td>
                    <td style={{color: 'var(--text-muted)'}}>{ind.dataSource}</td>
                    <td style={{color: 'var(--text-muted)'}}>{ind.lastUpdated}</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </div>
      );
    }

    // RiskTable Component
    function RiskTable({ indicators, statusFilter, setStatusFilter }) {
      const [currentPage, setCurrentPage] = useState(1);
      const itemsPerPage = 10;

      const filteredIndicators = statusFilter === 'all'
        ? indicators
        : indicators.filter(i => i.status === statusFilter);

      const totalPages = Math.ceil(filteredIndicators.length / itemsPerPage);
      const startIndex = (currentPage - 1) * itemsPerPage;
      const paginatedIndicators = filteredIndicators.slice(startIndex, startIndex + itemsPerPage);

      return (
        <div className="table-container">
          <div className="table-header">
            <h3>Risk indikatorlari</h3>
            <div className="table-filters">
              {['all', 'critical', 'high', 'medium', 'good'].map(status => (
                <button
                  key={status}
                  className={`filter-btn ${statusFilter === status ? 'active' : ''}`}
                  onClick={() => { setStatusFilter(status); setCurrentPage(1); }}
                >
                  {status === 'all' ? 'Barchasi' : getStatusLabel(status)}
                </button>
              ))}
            </div>
          </div>
          <table>
            <thead>
              <tr>
                <th>Indikator nomi</th>
                <th>Qiymat</th>
                <th>Status</th>
                <th>Manba</th>
                <th>Yangilangan</th>
              </tr>
            </thead>
            <tbody>
              {paginatedIndicators.map(ind => (
                <tr key={ind.id}>
                  <td>{ind.name}</td>
                  <td><strong>{ind.value}</strong></td>
                  <td>
                    <span className={`status-badge ${ind.status}`}>
                      <span className="status-dot"></span>
                      {getStatusLabel(ind.status)}
                    </span>
                  </td>
                  <td style={{color: 'var(--text-muted)'}}>{ind.dataSource}</td>
                  <td style={{color: 'var(--text-muted)'}}>{ind.lastUpdated}</td>
                </tr>
              ))}
            </tbody>
          </table>
          <div className="pagination">
            <span className="pagination-info">
              {startIndex + 1}-{Math.min(startIndex + itemsPerPage, filteredIndicators.length)} / {filteredIndicators.length}
            </span>
            <div className="pagination-buttons">
              <button
                className="pagination-btn"
                onClick={() => setCurrentPage(p => p - 1)}
                disabled={currentPage === 1}
              >
                Oldingi
              </button>
              <button
                className="pagination-btn"
                onClick={() => setCurrentPage(p => p + 1)}
                disabled={currentPage === totalPages}
              >
                Keyingi
              </button>
            </div>
          </div>
        </div>
      );
    }

    // Main App Component
    function App() {
      const [user, setUser] = useState(() => {
        const savedUser = localStorage.getItem('user') || sessionStorage.getItem('user');
        return savedUser ? JSON.parse(savedUser) : null;
      });
      const [showUserMenu, setShowUserMenu] = useState(false);
      const [showExportMenu, setShowExportMenu] = useState(false);
      const [isRefreshing, setIsRefreshing] = useState(false);
      const [activeCategory, setActiveCategory] = useState('all');
      const [statusFilter, setStatusFilter] = useState('all');
      const [searchQuery, setSearchQuery] = useState('');
      const [indicators, setIndicators] = useState(initialIndicators);

      const handleLogin = (userData) => {
        setUser(userData);
      };

      const handleLogout = () => {
        localStorage.removeItem('user');
        sessionStorage.removeItem('user');
        setShowUserMenu(false);
        setUser(null);
      };

      const handleRefresh = async () => {
        if (isRefreshing) return;
        setIsRefreshing(true);
        await new Promise(resolve => setTimeout(resolve, 1000));
        const refreshedIndicators = indicators.map(ind => ({
          ...ind,
          lastUpdated: new Date().toLocaleTimeString('uz-UZ', { hour: '2-digit', minute: '2-digit' })
        }));
        setIndicators(refreshedIndicators);
        setIsRefreshing(false);
      };

      const exportToPDF = () => {
        const printContent = `
          <!DOCTYPE html>
          <html>
          <head>
            <meta charset="UTF-8">
            <title>Risk Indikatorlar</title>
            <style>
              body { font-family: Arial, sans-serif; padding: 20px; }
              h1 { color: #1e293b; border-bottom: 2px solid #3b82f6; padding-bottom: 10px; }
              table { width: 100%; border-collapse: collapse; margin-top: 20px; }
              th { background: #3b82f6; color: white; padding: 12px 8px; text-align: left; }
              td { padding: 10px 8px; border-bottom: 1px solid #e2e8f0; }
            </style>
          </head>
          <body>
            <h1>Risk Indikatorlar</h1>
            <table>
              <thead><tr><th>Nomi</th><th>Qiymat</th><th>Status</th><th>Manba</th></tr></thead>
              <tbody>
                ${filteredIndicators.map(ind => `
                  <tr><td>${ind.name}</td><td>${ind.value}</td><td>${getStatusLabel(ind.status)}</td><td>${ind.dataSource}</td></tr>
                `).join('')}
              </tbody>
            </table>
          </body>
          </html>
        `;
        const printWindow = window.open('', '_blank');
        printWindow.document.write(printContent);
        printWindow.document.close();
        printWindow.print();
        setShowExportMenu(false);
      };

      const exportToExcel = () => {
        let csvContent = '\uFEFF';
        csvContent += 'Nomi;Qiymat;Status;Manba;Yangilangan\n';
        filteredIndicators.forEach(ind => {
          csvContent += `"${ind.name}";"${ind.value}";"${getStatusLabel(ind.status)}";"${ind.dataSource}";"${ind.lastUpdated}"\n`;
        });
        const blob = new Blob([csvContent], { type: 'application/vnd.ms-excel;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `risk-indikatorlar-${new Date().toISOString().split('T')[0]}.xls`;
        link.click();
        URL.revokeObjectURL(url);
        setShowExportMenu(false);
      };

      const filteredIndicators = indicators.filter(indicator => {
        const matchesCategory = activeCategory === 'all' || indicator.category === activeCategory;
        const matchesSearch = indicator.name.toLowerCase().includes(searchQuery.toLowerCase());
        return matchesCategory && matchesSearch;
      });

      const currentCategory = riskCategories.find(c => c.id === activeCategory);
      const isDashboard = activeCategory === 'all';

      if (!user) {
        return <Login onLogin={handleLogin} />;
      }

      return (
        <>
          <Sidebar activeCategory={activeCategory} setActiveCategory={setActiveCategory} />

          <main className="main-content">
            <header className="header">
              <div className="header-title">
                <h2>{currentCategory?.name || 'Dashboard'}</h2>
              </div>
              <div className="header-actions">
                {!isDashboard && (
                  <div className="search-box">
                    <SearchIcon />
                    <input
                      type="text"
                      placeholder="Indikator qidirish..."
                      value={searchQuery}
                      onChange={(e) => setSearchQuery(e.target.value)}
                    />
                  </div>
                )}
                <button
                  className={`header-btn ${isRefreshing ? 'refreshing' : ''}`}
                  title="Yangilash"
                  onClick={handleRefresh}
                  disabled={isRefreshing}
                >
                  <RefreshIcon />
                </button>

                <div className="export-menu-container">
                  <button
                    className="header-btn"
                    title="Saqlash"
                    onClick={() => setShowExportMenu(!showExportMenu)}
                  >
                    <DownloadIcon />
                  </button>
                  {showExportMenu && (
                    <div className="export-menu-dropdown">
                      <button className="export-menu-item" onClick={exportToPDF}>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                          <polyline points="14 2 14 8 20 8"/>
                        </svg>
                        PDF formatda saqlash
                      </button>
                      <button className="export-menu-item" onClick={exportToExcel}>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                          <polyline points="14 2 14 8 20 8"/>
                        </svg>
                        Excel formatda saqlash
                      </button>
                    </div>
                  )}
                </div>

                <div className="user-menu-container">
                  <button
                    className="user-menu-trigger"
                    onClick={() => setShowUserMenu(!showUserMenu)}
                  >
                    <div className="user-avatar">
                      <UserIcon />
                    </div>
                    <span className="user-name">{user.fullName}</span>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" className="user-chevron">
                      <path d="M6 9l6 6 6-6"/>
                    </svg>
                  </button>

                  {showUserMenu && (
                    <div className="user-menu-dropdown">
                      <div className="user-menu-header">
                        <div className="user-avatar-large">
                          <UserIcon />
                        </div>
                        <div className="user-info">
                          <span className="user-fullname">{user.fullName}</span>
                          <span className="user-role">{user.role === 'admin' ? 'Administrator' : 'Foydalanuvchi'}</span>
                        </div>
                      </div>
                      <button className="user-menu-item">
                        <SettingsIcon />
                        Sozlamalar
                      </button>
                      <button className="user-menu-item logout" onClick={handleLogout}>
                        <LogoutIcon />
                        Chiqish
                      </button>
                    </div>
                  )}
                </div>
              </div>
            </header>

            {isDashboard ? (
              <Dashboard />
            ) : (
              <div className="dashboard">
                <RiskTable
                  indicators={filteredIndicators}
                  statusFilter={statusFilter}
                  setStatusFilter={setStatusFilter}
                />
              </div>
            )}
          </main>

          {showUserMenu && (
            <div className="user-menu-overlay" onClick={() => setShowUserMenu(false)} />
          )}
          {showExportMenu && (
            <div className="export-menu-overlay" onClick={() => setShowExportMenu(false)} />
          )}
        </>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
